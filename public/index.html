<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Neon Evidence Blockchain</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
/* ---- SAME UI AS YOUR VERSION (kept exactly) ---- */
:root {
    --primary: #00f7ff;
    --primary-glow: #00ffee22;
    --secondary: #ff00d6;
    --accent: #ffd43b;
    --danger: #ff5c5c;
    --success: #00ff9d;
    --bg-dark: #020202;
    --card-bg: rgba(0, 0, 0, 0.45);
}

body {
    background: var(--bg-dark);
    color: var(--primary);
    font-family: 'Segoe UI', sans-serif;
    margin: 0;
    overflow-x: hidden;
    min-height: 100vh;
}

body::before {
    content: "";
    position: fixed;
    inset: 0;
    background:
        linear-gradient(var(--primary-glow) 1px, transparent 1px),
        linear-gradient(90deg, var(--primary-glow) 1px, transparent 1px);
    background-size: 40px 40px;
    animation: gridMove 15s linear infinite;
    z-index: -1;
}

body::after {
    content: "";
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: 
        radial-gradient(circle at 20% 30%, rgba(0, 255, 238, 0.05) 0%, transparent 50%),
        radial-gradient(circle at 80% 70%, rgba(255, 0, 214, 0.05) 0%, transparent 50%);
    z-index: -1;
    pointer-events: none;
}

@keyframes gridMove {
    from { background-position: 0 0; }
    to { background-position: 40px 40px; }
}

h1 {
    text-align: center;
    padding: 20px;
    text-shadow: 0 0 15px var(--primary);
    letter-spacing: 3px;
    font-size: 32px;
    position: relative;
    margin-bottom: 10px;
}

.container {
    width: 92%;
    max-width: 1200px;
    margin: auto;
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 25px;
}

.card {
    background: var(--card-bg);
    border: 1px solid var(--primary);
    padding: 25px;
    border-radius: 16px;
    box-shadow: 0 0 25px var(--primary-glow);
    backdrop-filter: blur(10px);
    position: relative;
    overflow: hidden;
}

textarea,input[type=file]{
    width:100%;
    background:#000;
    color:var(--primary);
    border:1px solid var(--primary);
    padding:12px;
    border-radius:8px;
    margin:8px 0 15px;
}
button{
    background:var(--primary);
    padding:12px 20px;
    border-radius:50px;
    cursor:pointer;
    font-weight:bold;
    box-shadow:0 0 16px var(--primary);
    margin-right:10px;
    margin-top:5px;
    border:none;
}
.freeze-btn{background:var(--accent);}
.invalidate-btn{background:var(--danger);}
.restore-btn{background:var(--success);}
.status-indicator{
    display:inline-block;width:10px;height:10px;border-radius:50%;
    background:var(--primary);box-shadow:0 0 8px var(--primary);animation:pulse 2s infinite;
}
@keyframes pulse{50%{opacity:0.3;}}

img.preview{
    max-width:100%;
    margin-top:10px;
    border-radius:8px;
}

.block{
    border:1px solid var(--primary);
    padding:18px;
    border-radius:10px;
    margin-bottom:20px;
    box-shadow:0 0 10px var(--primary-glow);
}
.badge{padding:6px 12px;font-size:11px;font-weight:bold;border-radius:20px;color:#000;}
.valid{background:var(--success);}
.invalid{background:var(--danger);}
.frozen{background:var(--accent);}
</style>
</head>

<body>

<h1>‚ö° NEON EVIDENCE BLOCKCHAIN</h1>

<div class="container">

<div class="card">
    <h2>Add Evidence</h2>

    <label>Evidence Text</label>
    <textarea id="text" rows="5" placeholder="Enter evidence..."></textarea>

    <label>Upload Image</label>
    <input type="file" id="image">

    <button onclick="addBlock()">Add Block</button>
    <button onclick="loadChain()">View Chain</button>
    <button onclick="validateChain()">Validate</button>
    <button class="restore-btn" onclick="restoreChain()">Restore Backup</button>

    <p id="status" style="margin-top:10px;"><span class="status-indicator"></span> Ready</p>
</div>

<div class="card">
    <h2>Blockchain</h2>
    <div id="chainBox"></div>
</div>

</div>

<script>
const API = "https://block-chain-0xps.onrender.com";

// ---------- ADD BLOCK ----------
async function addBlock(){
    const text = document.getElementById("text").value;
    const file = document.getElementById("image").files[0];
    if(!text.trim()) return setStatus("‚ö† Enter valid evidence text.");

    let fd = new FormData();
    fd.append("text",text);
    if(file) fd.append("image",file);

    setStatus("‚è≥ Adding block...");

    let res = await fetch(API+"/addBlock",{method:"POST",body:fd});
    await res.json();
    setStatus("‚úî Block Added Successfully");
    clearInputs();
    loadChain();
}

// ---------- VIEW CHAIN ----------
async function loadChain(){
    setStatus("‚è≥ Loading...");
    let res = await fetch(API+"/chain");
    let chain = await res.json();
    const box=document.getElementById("chainBox");
    box.innerHTML="";

    chain.forEach(b=>{
        box.innerHTML+=`
        <div class="block">
            <span class="badge ${b.status}">${b.status.toUpperCase()}</span>
            <p><b>Block #${b.index}</b></p>
            <p>${b.text}</p>
            <p><small><b>Hash:</b> ${b.hash}</small></p>
            ${b.imageId?`<img class="preview" src="${API}/file/${b.imageId}" onerror="this.remove()">`:""}
            <br><br>
            <button class="freeze-btn" onclick="freezeBlock(${b.index})">Freeze</button>
            <button class="invalidate-btn" onclick="invalidateBlock(${b.index})">Invalidate</button>
        </div>`;
    })

    setStatus(`‚úî Loaded ${chain.length} blocks`);
}

// ---------- VALIDATE ----------
async function validateChain(){
    setStatus("‚è≥ Validating...");
    let res = await fetch(API+"/validate");
    let data = await res.json();

    if(data.valid) setStatus("‚úî Blockchain VALID ‚Äî No tampering detected");
    else setStatus(`‚ùå INVALID ‚Äî ${data.reason}`);
}

// ---------- FREEZE ----------
async function freezeBlock(i){
    await fetch(API+"/freeze/"+i,{method:"POST"});
    loadChain();
}

// ---------- INVALIDATE ----------
async function invalidateBlock(i){
    await fetch(API+"/invalidate/"+i,{method:"POST"});
    loadChain();
}

// ---------- RESTORE from MASTER ----------
async function restoreChain(){
    setStatus("üîÅ Restoring from master backup...");
    await fetch(API+"/restore",{method:"POST"});
    setStatus("‚úî Recovery Successful ‚Äî Public DB Restored");
    loadChain();
}

// ---------- Utility ----------
function setStatus(msg){
    document.getElementById("status").innerHTML=`<span class="status-indicator"></span> ${msg}`;
}
function clearInputs(){
    document.getElementById("text").value="";
    document.getElementById("image").value="";
}

loadChain();
</script>

</body>
</html>
