<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Neon Evidence Blockchain</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
/* --- Styling same premium neon style --- */
:root {
    --primary:#00f7ff;
    --glow:#00ffee55;
    --danger:#ff4b4b;
    --success:#00ff95;
    --warning:#ffc400;
    --dark:#020202;
}

body {
    background: var(--dark);
    color: var(--primary);
    margin:0;
    font-family:"Segoe UI",sans-serif;
}

body::before {
    content:"";
    position:fixed;
    inset:0;
    background:
      linear-gradient(var(--glow) 1px,transparent 1px),
      linear-gradient(90deg,var(--glow) 1px,transparent 1px);
    background-size:40px 40px;
    animation:move 10s linear infinite;
    z-index:-1;
}

@keyframes move { to { background-position:40px 40px;} }

h1 {
    text-align:center;
    padding:20px;
    font-size:30px;
    text-shadow:0 0 15px var(--primary);
}

.container {
    width:90%;
    max-width:1200px;
    margin:auto;
    display:grid;
    grid-template-columns:1fr 1fr;
    gap:20px;
}

.card {
    background:rgba(0,0,0,.5);
    border:1px solid var(--primary);
    padding:20px;
    border-radius:15px;
    box-shadow:0 0 25px var(--glow);
}

/* Inputs */
textarea,input[type=file]{
    width:100%;
    background:#000;
    border:1px solid var(--primary);
    padding:10px;
    border-radius:8px;
    color:var(--primary);
    margin-top:10px;
}

/* Buttons */
button{
    background:var(--primary);
    color:black;
    border:none;
    padding:10px 18px;
    border-radius:25px;
    cursor:pointer;
    margin:5px;
    font-weight:bold;
    transition:.2s;
    box-shadow:0 0 10px var(--glow);
}
button:hover{ transform:scale(1.08); }

.restore-btn{ background:var(--success); }
.invalidate-btn{ background:var(--danger); }
.freeze-btn{ background:var(--warning); }

.status {
    margin-top:12px;
    font-size:14px;
}

/* Blockchain */
.block{
    border:1px solid var(--primary);
    margin-bottom:18px;
    padding:15px;
    border-radius:10px;
    box-shadow:0 0 15px var(--glow);
    animation:fade .4s ease;
}
@keyframes fade { from{opacity:0;} to{opacity:1;} }

.badge{
    padding:5px 10px;
    border-radius:15px;
    font-size:11px;
    font-weight:bold;
    color:black;
}

.valid{background:var(--success);}
.invalid{background:var(--danger);}
.frozen{background:var(--warning);}

img.preview{
    width:100%;
    border-radius:10px;
    margin-top:10px;
    border:1px solid var(--primary);
}
</style>
</head>

<body>

<h1>‚ö° Evidence Blockchain System</h1>

<div class="container">

<div class="card">
    <h2>Add Evidence</h2>

    <label>Description</label>
    <textarea id="text" rows="4"></textarea>

    <label>Upload Evidence Photo</label>
    <input type="file" id="image" accept="image/*">

    <button onclick="addBlock()">Add Block</button>
    <button onclick="loadChain()">View Chain</button>
    <button onclick="validateChain()">Validate</button>
    <button class="restore-btn" onclick="restoreChain()">Restore Backup</button>

    <p id="status" class="status">üü¢ System Ready</p>
</div>

<div class="card">
    <h2>Blockchain Data</h2>
    <div id="chainBox">Click "View Chain" üëÜ</div>
</div>

</div>


<script>
const API="https://block-chain-0xps.onrender.com";  // backend URL

function setStatus(msg){ document.getElementById("status").innerHTML=msg; }

// ADD BLOCK
async function addBlock(){
    const text=document.getElementById("text").value;
    const img=document.getElementById("image").files[0];

    if(!text.trim()) return setStatus("‚ö† Please enter text!");

    let fd=new FormData();
    fd.append("text",text);
    if(img) fd.append("image",img);

    setStatus("‚è≥ Adding block...");

    await fetch(API+"/addBlock",{ method:"POST", body:fd });
    setStatus("‚úî Block Added");
    document.getElementById("text").value="";
    document.getElementById("image").value="";
    loadChain();
}

// LOAD CHAIN
async function loadChain(){
    setStatus("‚è≥ Loading blockchain...");
    let res = await fetch(API+"/chain");
    let chain = await res.json();
    let box=document.getElementById("chainBox");
    box.innerHTML="";

    chain.forEach(b=>{
        box.innerHTML+=`
        <div class="block">
            <span class="badge ${b.status}">${b.status.toUpperCase()}</span>
            <h3>Block #${b.index}</h3>
            <p><b>Text:</b> ${b.text}</p>
            <p><b>Hash:</b> ${b.hash}</p>
            <p><b>Previous:</b> ${b.previousHash}</p>
            ${b.imageId?`<img class="preview" src="${API}/file/${b.imageId}" onerror="this.remove()">`:""}
            <br>
            <button class="freeze-btn" onclick="freezeBlock(${b.index})">Freeze</button>
            <button class="invalidate-btn" onclick="invalidateBlock(${b.index})">Invalidate</button>
        </div>`;
    });

    setStatus(`‚úî Loaded ${chain.length} blocks`);
}

// VALIDATE
async function validateChain(){
    setStatus("üîç Validating...");
    let r = await fetch(API+"/validate");
    let d = await r.json();
    if(d.valid) setStatus("üü¢ Blockchain VALID ‚úì");
    else setStatus("‚ùå INVALID ‚Üí "+d.reason);
}

// FREEZE
async function freezeBlock(i){
    await fetch(API+"/freeze/"+i,{method:"POST"});
    loadChain();
}

// INVALIDATE
async function invalidateBlock(i){
    await fetch(API+"/invalidate/"+i,{method:"POST"});
    loadChain();
}

// RESTORE
async function restoreChain(){
    setStatus("üîÅ Restoring data...");
    await fetch(API+"/restore",{method:"POST"});
    setStatus("‚úî Restored from Master Backup");
    loadChain();
}

// Auto show chain at start
loadChain();
</script>

</body>
</html>
