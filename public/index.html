<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Neon Evidence Blockchain</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body {
    background:#020202;
    color:#00f7ff;
    font-family:Segoe UI, sans-serif;
    margin:0;
    overflow-x:hidden;
}

/* Neon Grid Animation */
body::before {
    content:"";
    position:fixed;
    inset:0;
    background:
    linear-gradient(#00ffee22 1px, transparent 1px),
    linear-gradient(90deg,#00ffee22 1px, transparent 1px);
    background-size:40px 40px;
    animation:gridMove 15s linear infinite;
    z-index:-1;
}
@keyframes gridMove {
    from { background-position:0 0; }
    to { background-position:40px 40px; }
}

h1{
    text-align:center;
    padding:20px;
    text-shadow:0 0 15px #00ffee;
    letter-spacing:3px;
}

.container{
    width:92%;
    max-width:1200px;
    margin:auto;
    display:grid;
    grid-template-columns:1fr 1fr;
    gap:20px;
}

.card{
    background:rgba(0,0,0,0.45);
    border:1px solid #00ffee66;
    padding:20px;
    border-radius:14px;
    box-shadow:0 0 16px #00ffee55;
    backdrop-filter:blur(6px);
}

textarea, input[type="file"]{
    width:100%;
    background:#000;
    color:#00fff6;
    border:1px solid #00ffee44;
    padding:10px;
    border-radius:8px;
    margin:8px 0 12px;
    outline:none;
}

button{
    background:#00ffee;
    color:#000;
    border:none;
    padding:10px 18px;
    border-radius:50px;
    cursor:pointer;
    font-weight:bold;
    box-shadow:0 0 16px #00fff6;
    margin-right:8px;
    transition:.2s;
}
button:hover{
    transform:scale(1.07);
    box-shadow:0 0 22px #00fff6;
}

#chainBox{
    max-height:80vh;
    overflow-y:auto;
}

.block{
    margin-bottom:18px;
    padding:15px;
    border:1px solid #00ffee66;
    border-radius:12px;
    background:rgba(0,0,0,0.5);
    position:relative;
    box-shadow:0 0 16px #00ffee33;
    animation:fade .4s ease;
}
@keyframes fade{
    from{opacity:0; transform:translateY(10px);}
    to{opacity:1; transform:translateY(0);}
}

.block::before{
    content:"";
    position:absolute;
    left:-14px;
    top:0; bottom:0;
    width:3px;
    background:#00ffee;
    box-shadow:0 0 14px #00ffee;
    border-radius:5px;
}

.hash{
    font-size:12px;
    opacity:.8;
    word-break:break-all;
}

.badge{
    padding:4px 8px;
    font-size:11px;
    font-weight:bold;
    border-radius:6px;
    color:#000;
}
.valid{ background:#00ffd9; }
.invalid{ background:#ff5c5c; }
.frozen{ background:#ffd43b; }

img.preview{
    max-width:100%;
    margin-top:10px;
    border-radius:8px;
    box-shadow:0 0 12px #00ffee55;
}
</style>
</head>

<body>

<h1>⚡ Neon Evidence Blockchain</h1>

<div class="container">

<!-- FORM -->
<div class="card">
    <h2>Add Evidence</h2>

    <label>Text</label>
    <textarea id="text" placeholder="Enter evidence description..."></textarea>

    <label>Upload Image</label>
    <input type="file" id="image">

    <button onclick="addBlock()">Add Block</button>
    <button onclick="loadChain()">View Chain</button>
    <button onclick="validateChain()">Validate</button>

    <p id="status" style="margin-top:10px;"></p>
</div>

<!-- CHAIN -->
<div class="card">
    <h2>Blockchain</h2>
    <div id="chainBox"></div>
</div>

</div>

<script>
// BACKEND URL
const API = "https://block-chain-0xps.onrender.com";

// ADD BLOCK
async function addBlock(){
    const text = document.getElementById("text").value;
    const image = document.getElementById("image").files[0];

    const fd = new FormData();
    fd.append("text", text);
    if (image) fd.append("image", image);

    let res = await fetch(API + "/addBlock", {
        method: "POST",
        body: fd
    });

    let data = await res.json();
    document.getElementById("status").textContent = "Block Added ✔";
    loadChain();
}

// LOAD CHAIN
async function loadChain(){
    let res = await fetch(API + "/chain");
    let chain = await res.json();

    let box = document.getElementById("chainBox");
    box.innerHTML = "";

    chain.forEach(b => {
        box.innerHTML += `
        <div class="block">
            <span class="badge ${b.status}">${b.status.toUpperCase()}</span>

            <b>Block #${b.index}</b><br>

            <div class="hash">${b.text}</div>

            <div class="hash"><b>Image Hash:</b> ${b.imageHash}</div>

            <div class="hash"><b>Prev Hash:</b> ${b.previousHash}</div>
            <div class="hash"><b>Hash:</b> ${b.hash}</div>

            ${b.imageId ? `<img class="preview" src="${API}/file/${b.imageId}">` : ""}

            <br>
            <button onclick="freeze(${b.index})" style="background:#ffd43b;">Freeze</button>
            <button onclick="invalidate(${b.index})" style="background:#ff5c5c;">Invalidate</button>
        </div>
        `;
    });
}

// FREEZE
async function freeze(i){
    await fetch(API + "/freeze/" + i, { method: "POST" });
    loadChain();
}

// INVALIDATE
async function invalidate(i){
    await fetch(API + "/invalidate/" + i, { method: "POST" });
    loadChain();
}

// VALIDATE
async function validateChain(){
    let res = await fetch(API + "/validate");
    let data = await res.json();

    if (data.valid) 
        alert("Blockchain VALID ✔");
    else 
        alert("❌ Invalid: " + JSON.stringify(data));
}
</script>

</body>
</html>
